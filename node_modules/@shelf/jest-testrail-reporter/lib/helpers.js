"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.getCaseIdFromTestTitle = getCaseIdFromTestTitle;
exports.getTestRunsResults = getTestRunsResults;

var _stripAnsi = _interopRequireDefault(require("strip-ansi"));

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

const STATUS_IDS = {
  FAIL: 5,
  PASSED: 1
};

function getCaseIdFromTestTitle(testTitle) {
  const regexExecResult = /#C(?<caseId>[\d]*)/.exec(testTitle);
  return Number(regexExecResult.groups.caseId);
}

function getTestRunsResults(testRuns) {
  return testRuns.map(test => ({
    case_id: getCaseIdFromTestTitle(test.title),
    status_id: test.status === 'passed' ? STATUS_IDS.PASSED : STATUS_IDS.FAIL,
    comment: test.status === 'failed' ? (0, _stripAnsi.default)(test.failureMessages[0]) : ''
  }));
}